define(['jquery','uiComponent','Magento_Customer/js/customer-data','underscore','jquery/jquery-storageapi'],function($,Component,customerData,_){'use strict';return Component.extend({defaults:{cookieMessages:[],messages:[]},initialize:function(){this._super();this.cookieMessages=_.unique($.cookieStorage.get('mage-messages'),'text');this.messages=customerData.get('messages').extend({disposableCustomerData:'messages'});if(!_.isEmpty(this.messages().messages)){customerData.set('messages',{});}
var self=this;this.messages.subscribe(function(newVal){if(typeof newVal!=='object'||!newVal.data_id||self.old_data_id===newVal.data_id){return;}
$(".messages").show();if(typeof self.timeoutId=='number'){clearTimeout(self.timeoutId);}
self.timeoutId=setTimeout(self.hideMsg.bind(self),10000);self.old_data_id=newVal.data_id;});$.cookieStorage.set('mage-messages','');},hideMsg:function(){$(".messages").hide('blind',{},500);this.timeoutId=null;}});});